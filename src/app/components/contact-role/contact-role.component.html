<div class="p-grid">
    <div class="p-col-12">
        <div class="card">
            <p-toolbar styleClass="p-mb-4">
                <ng-template pTemplate="left">
                </ng-template>
                <ng-template pTemplate="right">
                    <button pButton pRipple label="New" icon="pi pi-plus" class="p-button-success p-mr-2 p-mb-2"
                        (click)="openNew()"></button>
                </ng-template>
            </p-toolbar>
                <p-table #dt [value]="contactRoleList" [rows]="10" [paginator]="true" [columns]="cols"
                    [globalFilterFields]="['name','description']" [rowHover]="true" resizableColumns="true"
                    [showCurrentPageReport]="true" styleClass="p-datatable-sm" dataKey="contactRoleId"
                    currentPageReportTemplate="Showing {first} to {last} of {totalRecords} record(s)">
                    <ng-template pTemplate="caption">
                        <div style="text-align: left">
                            <i class="fa fa-search" style="margin:4px 4px 0 0"></i>
                            <input type="text" pInputText size="30" placeholder="Search .."
                                (input)="dt.filterGlobal($event.target.value, 'contains')" style="width:auto">
                        </div>
                    </ng-template>
                    <ng-template pTemplate="header">
                        <tr>
                            <th pSortableColumn="name" class="ui-resizable-column" pResizableColumn>
                                Name
                                <p-columnFilter type="text" field="name" display="menu"></p-columnFilter>
                            </th>
                            <th pSortableColumn="description" class="ui-resizable-column" pResizableColumn>
                                Description
                                <p-columnFilter type="text" field="description" display="menu"></p-columnFilter>
                            </th>
                            <th pSortableColumn="active">
                                Status
                            </th>
                            <th></th>
                        </tr>
                    </ng-template>
                    <ng-template pTemplate="body" let-role>
                        <tr class="maxTableRow">
                            <td>
                                {{ role.name }}
                            </td>
                            <td>
                                {{ role.description }}
                            </td>
                            <td style="text-align: left;">
                                <div *ngIf="role.active; else elseStatusBlock"><p-tag styleClass="p-mr-2"
                                        severity="success" value="Active" [rounded]="true"></p-tag></div>
                                <ng-template #elseStatusBlock><p-tag styleClass="p-mr-2" severity="danger"
                                        value="Inactive" [rounded]="true"></p-tag></ng-template>
                                        <p-menu #menu [popup]="true" [model]="items" position="left" appendTo="body"></p-menu>
                            </td>
                            <td style="text-align: left;">
                                <button type="button" pButton icon="pi pi-ellipsis-v"
                                    (click)="setActiveRow(role); menu.toggle($event)"></button>
                            </td>
                        </tr>
                    </ng-template>
                </p-table>
        </div>
        <div *ngIf="showForm">
        <form [formGroup]="contactRoleForm">
            <p-dialog [(visible)]="showForm" [style]="{ width: '600px' }" header="Contact Role" [modal]="true" styleClass="p-fluid" (onHide)="hideForm()">
                <ng-template pTemplate="content">
            <div class="p-fluid p-formgrid p-grid">
                <div class="p-field p-col-12" [ngClass]="errorIconCss('Name')">
                    <label for="Name">Name</label>
                    <input type="text" pInputText formControlName="Name" autocomplete="new-password"
                        (click)="resetSubmitted('Name')" autofocus [ngClass]="errorFieldCss('Name')" 
                        (paste)="matcher($event, 'Name')" maxlength="50"/>
                    <app-field-error-display [displayError]="isFieldValid('Name')"
                        [addErrorMessages]="addErrorMessages">
                    </app-field-error-display>
                </div>
                <div class="p-field p-col-12" [ngClass]="errorIconCss('Description')">
                    <label for="Description">Description</label>
                    <textarea type="text" rows="2" pInputText formControlName="Description" autocomplete="new-password"
                        (click)="resetSubmitted('Description')" [ngClass]="errorFieldCss('Description')" maxlength="255"></textarea>
                    <app-field-error-display [displayError]="isFieldValid('Description')"
                        [addErrorMessages]="addErrorMessages">
                    </app-field-error-display>
                </div>
                <div class="p-field p-col-12">
                    <div>
                        <label for="Active">Active</label>
                        <div class="p-field p-col-3 p-d-flex" style="padding-top: 15px;">
                            <p-inputSwitch formControlName='Active'></p-inputSwitch>
                        </div>
                    </div>
                </div>
               
            </div>
        </ng-template>
        <ng-template pTemplate="footer">
          <button pButton pRipple label="Save" icon="pi pi-save" class="p-button-success p-mr-2 p-mb-2" type="submit" (click)="saveContactRole()"></button>
          <button pButton pRipple label="Cancel" icon="pi pi-cross" class="p-button-danger p-mb-2" (click)="hideForm()"></button>
        </ng-template>
      </p-dialog>
        </form>
    </div>
        <p-confirmDialog [style]="{ width: '450px' }"></p-confirmDialog>
    </div>
</div>